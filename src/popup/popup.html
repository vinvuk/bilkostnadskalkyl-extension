<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bilkostnadskalkyl</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="popup">
    <header class="header">
      <div class="logo">
        <div class="logo-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="4" y="2" width="16" height="20" rx="2"/>
            <rect x="7" y="5" width="10" height="4" rx="1"/>
            <circle cx="8" cy="13" r="1" fill="currentColor"/>
            <circle cx="12" cy="13" r="1" fill="currentColor"/>
            <circle cx="16" cy="13" r="1" fill="currentColor"/>
            <circle cx="8" cy="17" r="1" fill="currentColor"/>
            <circle cx="12" cy="17" r="1" fill="currentColor"/>
          </svg>
        </div>
        <span>Bilkostnadskalkyl</span>
      </div>
    </header>

    <!-- Tabs -->
    <nav class="tabs">
      <button class="tab active" data-tab="about">Om</button>
      <button class="tab" data-tab="history">
        Historik
        <span class="tab-badge" id="historyBadge" style="display: none;">0</span>
      </button>
      <button class="tab" data-tab="account">Konto</button>
    </nav>

    <!-- About Tab -->
    <main class="main tab-content active" id="aboutTab">
      <section class="section about-intro">
        <p class="about-description">
          Beräkna den verkliga månadskostnaden för bilar direkt på annonssidor.
          Inkluderar värdeminskning, bränsle, försäkring, skatt och mer.
        </p>
      </section>

      <section class="section">
        <h2 class="section-title">Fungerar på</h2>
        <div class="supported-sites">
          <a href="https://www.blocket.se/bilar" target="_blank" class="site-item">
            <span class="site-name">Blocket.se</span>
            <span class="site-status active">Aktiv</span>
          </a>
          <a href="https://www.wayke.se" target="_blank" class="site-item">
            <span class="site-name">Wayke.se</span>
            <span class="site-status active">Aktiv</span>
          </a>
          <a href="https://www.carla.se" target="_blank" class="site-item">
            <span class="site-name">Carla.se</span>
            <span class="site-status active">Aktiv</span>
          </a>
        </div>
      </section>

      <section class="section">
        <h2 class="section-title">Användning</h2>
        <p class="about-usage">
          Besök en bilannons på någon av sidorna ovan. Kalkylatorn visas automatiskt
          med beräknad månadskostnad. Klicka på sektionerna för att justera värden.
        </p>
      </section>

    </main>

    <!-- History Tab -->
    <main class="main tab-content" id="historyTab">
      <div class="history-list" id="historyList">
        <!-- History items will be inserted here -->
      </div>
      <div class="history-empty" id="historyEmpty">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        <p>Ingen historik ännu</p>
        <span>Besök bilannonser för att börja spara</span>
      </div>
    </main>

    <!-- Account Tab -->
    <main class="main tab-content" id="accountTab">
      <!-- Logged out state -->
      <div id="accountLoggedOut">
        <section class="section about-intro">
          <p class="about-description">
            Logga in för att synka din bilhistorik och hantera ditt konto på dinbilkostnad.se.
          </p>
        </section>
        <section class="section">
          <div class="login-form">
            <input type="email" id="loginEmail" placeholder="din@email.se" class="login-input">
            <p class="login-error" id="loginError" style="display: none;"></p>
            <button id="loginBtn" class="btn btn-primary login-btn">Skicka inloggningslänk</button>
            <p class="login-hint" id="loginHint" style="display: none;">
              Kolla din inkorg och klicka på länken för att logga in.
            </p>
          </div>
        </section>
      </div>
      <!-- Logged in state -->
      <div id="accountLoggedIn" style="display: none;">
        <section class="section about-intro">
          <p class="about-description">
            Inloggad som <strong id="accountEmail"></strong>
          </p>
        </section>
        <section class="section">
          <h2 class="section-title">Datadelning</h2>
          <div class="consent-toggle">
            <label class="toggle-label">
              <span>Dela bilsökningsdata</span>
              <input type="checkbox" id="dataSharingToggle" class="toggle-input">
              <span class="toggle-slider"></span>
            </label>
            <p class="consent-description">
              Din data anonymiseras och delas med bilhandlare. Du kan ändra detta när som helst.
            </p>
          </div>
        </section>
        <section class="section">
          <a href="https://dinbilkostnad.se/profil" target="_blank" class="btn btn-secondary profile-link">
            Min profil på dinbilkostnad.se
          </a>
          <button id="logoutBtn" class="btn btn-secondary logout-btn">Logga ut</button>
        </section>
      </div>
    </main>

    <footer class="footer">
      <span class="version">v1.2.3</span>
      <button id="clearHistoryBtn" class="btn btn-secondary" style="display: none;">Rensa historik</button>
    </footer>
  </div>

  <script src="popup.js"></script>
</body>
</html>
